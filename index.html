<!DOCTYPE html>
<html>
<head>
    <title>Energy Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial, text-align: center; background: #6c5ce7; color: white; padding: 20px; }
        #clicker { width: 200px; height: 200px; background: #fd79a8; border-radius: 50%; margin: 30px auto; 
                 display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Energy Clicker</h1>
    <div>Энергия: <span id="energy">0</span>⚡</div>
    <div id="clicker">КЛИКАЙ!</div>
    <button onclick="buyUpgrade()">Улучшение (+1⚡/клик) - 10⚡</button>

    <script>
        // Игровые переменные
        let energy = 0;
        let energyPerClick = 1;
        let energyPerSecond = 0;
        
        // Инициализация Telegram WebApp
        Telegram.WebApp.expand();
        Telegram.WebApp.ready();
        
        // Обновление интерфейса
        function updateEnergy() {
            document.getElementById('energy').textContent = energy;
            saveToDB(); // Сохраняем при каждом изменении
        }
        
        // Обработка кликов
        document.getElementById('clicker').addEventListener('click', () => {
            energy += energyPerClick;
            updateEnergy();
        });
        
        // Покупка улучшений
        function buyUpgrade() {
            if (energy >= 10) {
                energy -= 10;
                energyPerClick += 1;
                updateEnergy();
                alert(`Улучшение куплено! Теперь вы получаете ${energyPerClick}⚡ за клик`);
            }
        }
        
        // Сохранение в БД через бота
        function saveToDB() {
            const gameData = {
                energy: energy,
                energyPerClick: energyPerClick,
                energyPerSecond: energyPerSecond
            };
            
            if (window.Telegram?.WebApp?.sendData) {
                Telegram.WebApp.sendData(JSON.stringify(gameData));
                console.log("Данные отправлены в бота:", gameData);
            }
        }
        
        // Автосохранение каждые 20 сек
        setInterval(saveToDB, 20000);
    </script>
</body>
</html>
